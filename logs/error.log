2019-04-12 10:19:18,866 40 db_mysql.py [58]: get special aggregation data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 52, in loadDictionary
    conn.execute(sql)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 165, in execute
    result = self._query(query)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 321, in _query
    conn.query(q)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 860, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1061, in _read_query_result
    result.read()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1349, in read
    first_packet = self.connection._read_packet()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1018, in _read_packet
    packet.check_error()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'stargazer_business.keyword_dic' doesn't exist")
2019-04-12 10:23:35,479 40 db_mysql.py [39]: connect mysql failure
Traceback (most recent call last):
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 920, in connect
    **kwargs)
  File "D:\Program Files\Python\python35\lib\socket.py", line 694, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File "D:\Program Files\Python\python35\lib\socket.py", line 733, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 37, in getMysqlConnect
    conn = pymysql.connect(host=host, user=username, passwd=password, db=database, port=port, charset=charset ,autocommit=False,cursorclass=pymysql.cursors.Cursor)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 699, in __init__
    self.connect()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '172.16.17.115:3306' ([Errno 11001] getaddrinfo failed)")
2019-04-12 10:23:35,489 40 db_mysql.py [58]: get special aggregation data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 50, in loadDictionary
    with getMysqlConnect() as conn:
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 40, in getMysqlConnect
    return conn
UnboundLocalError: local variable 'conn' referenced before assignment
2019-04-12 10:25:52,479 40 db_mysql.py [39]: connect mysql failure
Traceback (most recent call last):
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 920, in connect
    **kwargs)
  File "D:\Program Files\Python\python35\lib\socket.py", line 694, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File "D:\Program Files\Python\python35\lib\socket.py", line 733, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 37, in getMysqlConnect
    conn = pymysql.connect(host=host, user=username, passwd=password, db=database, port=port, charset=charset ,autocommit=False,cursorclass=pymysql.cursors.Cursor)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 699, in __init__
    self.connect()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '172.16.17.115:3306' ([Errno 11001] getaddrinfo failed)")
2019-04-12 10:25:52,499 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 50, in loadDictionary
    with getMysqlConnect() as conn:
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 40, in getMysqlConnect
    return conn
UnboundLocalError: local variable 'conn' referenced before assignment
2019-04-12 10:27:11,590 40 db_mysql.py [39]: connect mysql failure
Traceback (most recent call last):
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 920, in connect
    **kwargs)
  File "D:\Program Files\Python\python35\lib\socket.py", line 694, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File "D:\Program Files\Python\python35\lib\socket.py", line 733, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 37, in getMysqlConnect
    conn = pymysql.connect(host=host, user=username, passwd=password, db=database, port=port, charset=charset ,autocommit=False,cursorclass=pymysql.cursors.Cursor)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 699, in __init__
    self.connect()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '172.16.17.115:3306' ([Errno 11001] getaddrinfo failed)")
2019-04-12 10:27:11,597 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 50, in loadDictionary
    with getMysqlConnect() as conn:
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 40, in getMysqlConnect
    return conn
UnboundLocalError: local variable 'conn' referenced before assignment
2019-04-12 10:29:24,321 40 db_mysql.py [39]: connect mysql failure
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 37, in getMysqlConnect
    conn = pymysql.connect(host=host, user=username, passwd=password, db=database, port=port, charset=charset ,autocommit=False,cursorclass=pymysql.cursors.Cursor)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 669, in __init__
    self.encoding = charset_by_name(self.charset).encoding
AttributeError: 'NoneType' object has no attribute 'encoding'
2019-04-12 10:29:26,793 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 50, in loadDictionary
    with getMysqlConnect() as conn:
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 40, in getMysqlConnect
    return conn
UnboundLocalError: local variable 'conn' referenced before assignment
2019-04-12 10:38:15,535 40 db_mysql.py [39]: connect mysql failure
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 37, in getMysqlConnect
    conn = pymysql.connect(host=host, user=username, passwd=password, db=database, port=port, charset=charset ,autocommit=False,cursorclass=pymysql.cursors.Cursor)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 669, in __init__
    self.encoding = charset_by_name(self.charset).encoding
AttributeError: 'NoneType' object has no attribute 'encoding'
2019-04-12 10:38:15,556 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 50, in loadDictionary
    with getMysqlConnect() as conn:
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 40, in getMysqlConnect
    return conn
UnboundLocalError: local variable 'conn' referenced before assignment
2019-04-12 10:41:19,981 40 db_mysql.py [39]: connect mysql failure
Traceback (most recent call last):
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 920, in connect
    **kwargs)
  File "D:\Program Files\Python\python35\lib\socket.py", line 694, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File "D:\Program Files\Python\python35\lib\socket.py", line 733, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 37, in getMysqlConnect
    conn = pymysql.connect(host=host, user=username, passwd=password, db=database, port=port, charset=charset ,autocommit=False,cursorclass=pymysql.cursors.Cursor)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 699, in __init__
    self.connect()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '172.16.17.115:3306' ([Errno 11001] getaddrinfo failed)")
2019-04-12 10:41:20,002 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 50, in loadDictionary
    with getMysqlConnect() as conn:
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 40, in getMysqlConnect
    return conn
UnboundLocalError: local variable 'conn' referenced before assignment
2019-04-12 10:51:32,275 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 52, in loadDictionary
    conn.execute(sql)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 165, in execute
    result = self._query(query)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 321, in _query
    conn.query(q)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 860, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1061, in _read_query_result
    result.read()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1349, in read
    first_packet = self.connection._read_packet()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1018, in _read_packet
    packet.check_error()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1054, "Unknown column 'word，freq，tag' in 'field list'")
2019-04-12 11:04:02,421 40 db_mysql.py [58]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 56, in loadDictionary
    keywords.append([record[0],record[1],record[2]].join('\t') + ' \n')
AttributeError: 'list' object has no attribute 'join'
2019-04-12 18:45:17,591 40 db_mysql.py [75]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 71, in saveDataToDb
    num = conn.executemany(sqls)
TypeError: executemany() missing 1 required positional argument: 'args'
2019-04-12 18:48:37,911 40 db_mysql.py [76]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 72, in saveDataToDb
    num = conn.executemany(sql,)
TypeError: executemany() missing 1 required positional argument: 'args'
2019-04-12 18:49:16,015 40 db_mysql.py [76]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 72, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 18:51:00,981 40 db_mysql.py [76]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 72, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 18:53:28,742 40 db_mysql.py [76]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 72, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 18:56:20,541 40 db_mysql.py [76]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 72, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 19:01:36,971 40 db_mysql.py [79]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 72, in saveDataToDb
    for keyword, num in result:
TypeError: 'int' object is not iterable
2019-04-12 19:09:27,103 40 db_mysql.py [79]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 75, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 19:15:25,022 40 db_mysql.py [79]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 75, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 19:18:12,223 40 db_mysql.py [79]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 75, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 19:24:42,849 40 db_mysql.py [79]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 75, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
TypeError: %d format: a number is required, not str
2019-04-12 19:28:11,042 40 db_mysql.py [79]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 75, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 165, in execute
    result = self._query(query)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 321, in _query
    conn.query(q)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 860, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1061, in _read_query_result
    result.read()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1349, in read
    first_packet = self.connection._read_packet()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1018, in _read_packet
    packet.check_error()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1136, "Column count doesn't match value count at row 1")
2019-04-12 19:34:38,469 40 db_mysql.py [82]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 78, in saveDataToDb
    num = conn.executemany(sql,data,Date(),Date())
TypeError: Required argument 'year' (pos 1) not found
2019-04-12 19:35:50,584 40 db_mysql.py [82]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 78, in saveDataToDb
    num = conn.executemany(sql,data,Date(2019,3,23),Date(2019,3,23))
TypeError: executemany() takes 3 positional arguments but 5 were given
2019-04-12 19:41:32,060 40 db_mysql.py [81]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 74, in saveDataToDb
    for keyword, num in result:
TypeError: 'int' object is not iterable
2019-04-15 19:25:24,556 40 db_mysql.py [123]: get keyword data error
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/db/db_mysql.py", line 117, in findAllMallId
    date = datetime.datetime.now()
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
2019-04-15 19:26:39,421 40 db_mysql.py [119]: get keyword data error
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/db/db_mysql.py", line 115, in findAllMallId
    result = conn.execute(sql)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 165, in execute
    result = self._query(query)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 321, in _query
    conn.query(q)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 860, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1061, in _read_query_result
    result.read()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1349, in read
    first_packet = self.connection._read_packet()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 1018, in _read_packet
    packet.check_error()
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1054, "Unknown column 'mallId' in 'field list'")
2019-04-15 19:27:38,804 40 db_mysql.py [119]: get keyword data error
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/db/db_mysql.py", line 116, in findAllMallId
    logger.info("查找到{0}条记录".format(len(result)))
TypeError: object of type 'int' has no len()
2019-04-16 19:09:24,882 40 db_mysql.py [119]: get mallid data failure
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/db/db_mysql.py", line 117, in findAllMallId
    return set([key for key, value in result])
  File "D:/NLP Project/comment_extract/db/db_mysql.py", line 117, in <listcomp>
    return set([key for key, value in result])
ValueError: not enough values to unpack (expected 2, got 1)
2019-04-16 19:14:59,665 40 extract_comment_keyword.py [235]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 220, in apiInvoke
    subset = ids[i: i + batchSize]
TypeError: 'set' object is not subscriptable
2019-04-16 19:47:10,719 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 123, in processMongoData
    commentMap = getMongoData(collection = collection,ids = ids, date = date)  ## 获取mongodb中的评论数据
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 122, in getMongoData
    query = generateQuery(subjectIdField,subjectType,starttime,ids)
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 85, in generateQuery
    starttime = starttime + datetime.timedelta(days=1)
AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
2019-04-17 11:00:16,430 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 123, in processMongoData
    commentMap = getMongoData(collection = collection,ids = ids, date = date)  ## 获取mongodb中的评论数据
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 144, in getMongoData
    commentMap.get(subjectId)["pos"].append(res.get('content'))
KeyError: 'pos'
2019-04-17 11:28:34,350 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 135, in processMongoData
    result = MergeHistroyFromES(key,value["type"],const.NEGATIVE_COMMENT, result)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 177, in MergeHistroyFromES
    return dict[:20]
TypeError: unhashable type: 'slice'
2019-04-17 11:31:46,819 40 db_mysql.py [86]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 79, in saveDataToDb
    for keyword, num in result:
TypeError: 'Int64' object is not iterable
2019-04-17 11:31:46,847 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 130, in processMongoData
    result = getAnalyseData(value["pos"])
TypeError: 'NoneType' object is not subscriptable
2019-04-17 11:40:42,432 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 137, in processMongoData
    saveDataToDb((key, value["type"],commentType, result))
TypeError: saveDataToDb() missing 3 required positional arguments: 'subjectType', 'commentType', and 'result'
2019-04-17 11:43:12,209 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 137, in processMongoData
    saveDataToDb((key, value["type"],commentType, result))
TypeError: saveDataToDb() missing 3 required positional arguments: 'subjectType', 'commentType', and 'result'
2019-04-17 11:44:55,767 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 137, in processMongoData
    saveDataToDb((key, value["type"],commentType, result))
TypeError: saveDataToDb() missing 3 required positional arguments: 'subjectType', 'commentType', and 'result'
2019-04-17 11:48:32,778 40 db_mysql.py [86]: get keyword data error
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mysql.py", line 82, in saveDataToDb
    num = conn.executemany(sql,data)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in executemany
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 194, in <genexpr>
    self.rowcount = sum(self.execute(query, arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 163, in execute
    query = self.mogrify(query, args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 142, in mogrify
    query = query % self._escape_args(args, conn)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 117, in _escape_args
    return tuple(conn.literal(arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\cursors.py", line 117, in <genexpr>
    return tuple(conn.literal(arg) for arg in args)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 819, in literal
    return self.escape(obj, self.encoders)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\connections.py", line 812, in escape
    return converters.escape_item(obj, self.charset, mapping=mapping)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\converters.py", line 27, in escape_item
    val = encoder(val, mapping)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\converters.py", line 118, in escape_unicode
    return u"'%s'" % _escape_unicode(value)
  File "D:\Program Files\Python\python35\lib\site-packages\pymysql\converters.py", line 73, in _escape_unicode
    return value.translate(_escape_table)
AttributeError: 'Int64' object has no attribute 'translate'
2019-04-17 11:48:32,896 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 130, in processMongoData
    result = getAnalyseData(value["pos"])
TypeError: 'NoneType' object is not subscriptable
2019-04-17 11:57:27,660 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 130, in processMongoData
    result = getAnalyseData(value["pos"])
TypeError: 'NoneType' object is not subscriptable
2019-04-17 12:00:03,577 40 extract_comment_keyword.py [236]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 221, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 130, in processMongoData
    result = getAnalyseData(value[commentType])
TypeError: 'NoneType' object is not subscriptable
2019-04-17 15:22:02,327 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,372 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,372 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,374 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,376 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,377 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,378 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,379 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,325 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:22:02,328 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,763 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,764 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,769 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,770 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,771 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,772 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,772 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,774 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,774 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,776 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,776 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,778 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,778 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,780 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,780 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,782 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,784 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,785 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,787 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,789 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,791 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,793 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,795 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,797 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,800 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,802 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,804 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,806 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,808 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,810 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,811 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,814 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,816 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,817 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,819 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,821 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,823 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,825 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,827 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:23:32,829 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,655 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,661 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,666 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,666 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,667 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,672 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,672 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,673 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,674 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,674 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,675 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:31:45,676 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,350 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,351 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,350 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,357 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,357 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,358 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,363 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,363 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,364 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,364 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,365 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,366 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,366 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,367 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,367 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,370 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,370 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,372 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,372 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,374 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,375 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,376 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,377 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,378 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,379 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,381 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,382 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,443 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,445 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,448 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,450 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,451 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,451 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,455 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,457 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,458 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,460 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,460 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,462 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-17 15:35:51,463 40 db_mongo.py [44]: 时间格式参数不正确，参数：
2019-04-18 17:28:55,283 40 extract_comment_keyword.py [240]: exception now
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 76, in generateQuery
    num = exists(key)
  File "D:\NLP Project\comment_extract\db\db_redis.py", line 38, in exists
    key = str(key, encoding='utf-8')
TypeError: decoding str is not supported

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 225, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 123, in processMongoData
    commentMap = getMongoData(collection = collection,ids = ids, date = date)  ## 获取mongodb中的评论数据
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 122, in getMongoData
    query = generateQuery(subjectIdField,subjectType,starttime,ids)
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 79, in generateQuery
    logger.error("redis 判断key:{0}是否存在出错".format(key),exec_info = 1)
  File "D:\Program Files\Python\python35\lib\logging\__init__.py", line 1314, in error
    self._log(ERROR, msg, args, **kwargs)
TypeError: _log() got an unexpected keyword argument 'exec_info'
2019-04-18 17:35:31,006 40 db_mongo.py [79]: redis 判断key:JOYCITY:REDIS:COMMENT:0_?_*是否存在出错
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 76, in generateQuery
    num = exists(key)
  File "D:\NLP Project\comment_extract\db\db_redis.py", line 38, in exists
    key = str(key, encoding='utf-8')
TypeError: decoding str is not supported
2019-04-18 17:35:32,166 40 db_mongo.py [79]: redis 判断key:JOYCITY:REDIS:COMMENT:0_?_*是否存在出错
Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 76, in generateQuery
    num = exists(key)
  File "D:\NLP Project\comment_extract\db\db_redis.py", line 38, in exists
    key = str(key, encoding='utf-8')
TypeError: decoding str is not supported
2019-04-18 17:39:22,993 40 db_mongo.py [79]: redis 判断key:JOYCITY:REDIS:COMMENT:0_?_*是否存在出错
Traceback (most recent call last):
  File "D:\Program Files\Python\python35\lib\site-packages\redis\connection.py", line 988, in get_connection
    connection = self._available_connections.pop()
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 76, in generateQuery
    num = exists(key)
  File "D:\NLP Project\comment_extract\db\db_redis.py", line 39, in exists
    return r.exists(key)
  File "D:\Program Files\Python\python35\lib\site-packages\redis\client.py", line 1239, in exists
    return self.execute_command('EXISTS', *names)
  File "D:\Program Files\Python\python35\lib\site-packages\redis\client.py", line 772, in execute_command
    connection = pool.get_connection(command_name, **options)
  File "D:\Program Files\Python\python35\lib\site-packages\redis\connection.py", line 990, in get_connection
    connection = self.make_connection()
  File "D:\Program Files\Python\python35\lib\site-packages\redis\connection.py", line 1025, in make_connection
    return self.connection_class(**self.connection_kwargs)
TypeError: __init__() got an unexpected keyword argument 'database'
2019-04-18 17:46:20,946 40 db_mongo.py [79]: redis 判断key:JOYCITY:REDIS:COMMENT:0_?_*是否存在出错
Traceback (most recent call last):
  File "D:\Program Files\Python\python35\lib\site-packages\redis\connection.py", line 988, in get_connection
    connection = self._available_connections.pop()
IndexError: pop from empty list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\NLP Project\comment_extract\db\db_mongo.py", line 76, in generateQuery
    num = exists(key)
  File "D:\NLP Project\comment_extract\db\db_redis.py", line 39, in exists
    return r.exists(key)
  File "D:\Program Files\Python\python35\lib\site-packages\redis\client.py", line 1239, in exists
    return self.execute_command('EXISTS', *names)
  File "D:\Program Files\Python\python35\lib\site-packages\redis\client.py", line 772, in execute_command
    connection = pool.get_connection(command_name, **options)
  File "D:\Program Files\Python\python35\lib\site-packages\redis\connection.py", line 990, in get_connection
    connection = self.make_connection()
  File "D:\Program Files\Python\python35\lib\site-packages\redis\connection.py", line 1025, in make_connection
    return self.connection_class(**self.connection_kwargs)
TypeError: __init__() got an unexpected keyword argument 'charset'
2019-04-18 18:10:47,122 40 extract_comment_keyword.py [240]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 225, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 137, in processMongoData
    result = MergeHistroyFromES(key,value["type"],const.NEGATIVE_COMMENT, result)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 179, in MergeHistroyFromES
    putValue(key, json.dumps(dict(res[:50])))
TypeError: 'dict' object is not callable
2019-04-18 18:22:13,891 40 extract_comment_keyword.py [240]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 225, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 137, in processMongoData
    result = MergeHistroyFromES(key,value["type"],const.NEGATIVE_COMMENT, result)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 172, in MergeHistroyFromES
    dictFreq = json.loads(redisResult)
  File "D:\Program Files\Python\python35\lib\json\__init__.py", line 312, in loads
    s.__class__.__name__))
TypeError: the JSON object must be str, not 'bytes'
2019-04-18 19:09:11,906 40 extract_comment_keyword.py [240]: exception now
Traceback (most recent call last):
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 225, in apiInvoke
    processMongoData(collection,subset, strDate)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 137, in processMongoData
    result = MergeHistroyFromES(key,value["type"],const.NEGATIVE_COMMENT, result)
  File "D:/NLP Project/comment_extract/script/extract_comment_keyword.py", line 172, in MergeHistroyFromES
    dictFreq = json.loads(redisResult,ensure_ascii=False)
  File "D:\Program Files\Python\python35\lib\json\__init__.py", line 332, in loads
    return cls(**kw).decode(s)
TypeError: __init__() got an unexpected keyword argument 'ensure_ascii'
